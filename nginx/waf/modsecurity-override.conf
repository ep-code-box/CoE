# This file overrides/extends the base ModSecurity config in the
# owasp/modsecurity-crs:nginx image. It is safe to keep it minimal.

# Start in detection-only mode. Switch to On after tuning.
SecRuleEngine DetectionOnly

# Example custom policy: limit unusual content-types on entity-modifying methods
SecRule REQUEST_METHOD "^(?:POST|PUT|PATCH)$" \
  "id:910020,phase:1,log,chain,deny,status:415,msg:'Suspicious content-type'"
  SecRule REQUEST_HEADERS:Content-Type "(?i)^(?:multipart\/form-data|application\/json|application\/x-www-form-urlencoded|text\/plain)(?:;|$)" "negate"

